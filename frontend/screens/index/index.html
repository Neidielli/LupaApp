<!DOCTYPE html>
<html>

<head>
    <title>Inicio</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="./../css_geral.css">
    <link rel="stylesheet" type="text/css" href="./index.css">
    <link rel="stylesheet" type="text/css" href="./../home/home.css">
    <script src="index.js"></script>
    <script src="../home/home.js"></script>
</head>

<!-- <script src="./../../../exportPDF.js"></script> -->

<body>

    <main>
        <div id="header">
            <div class="itemHeader">
                <img src="../../assets/images/LupaLogo.png" width="65" height="65">
                <span>Lupa</span>
            </div>
            <div class="itemHeader">
                <button onclick="window.location.href='../novoProduto/novoProduto.html?mode=Cadastrar';">Novo Produto</button>
                <button id="exportPdf">Gerar Catálogo</button>
            </div>
        </div> <!-- Fim Header -->

        <div id="CardEmpresas">
            <div class="itemEmpresas" onclick="redirecionar('Gusman')">
                <h1>Gusman</h1>
                <img src="../../assets/images/gusmanLogo.png" width="175" height="150">
            </div>

            <div class="itemEmpresas" onclick="redirecionar('Pipoteca')">
                <h1>Pipoteca</h1>
                <img src="../../assets/images/pipotecaLogo.png" width="175" height="150">
            </div>

            <div class="itemEmpresas" onclick="redirecionar('Tintos')">
                <h1>Tintos</h1>
                <img src="" onclick="redirecionar('Tintos')">
            </div>

            <div class="itemEmpresas" onclick="redirecionar('Doce Sabor')">
                <h1>Doce Sabor</h1>
                <img src="../../assets/images/doceSaborLogo.png" width="175" height="150">
            </div>

            <div class="itemEmpresas" onclick="redirecionar('Doces')">
                <h1>Doces</h1>
                <img src="../../assets/images/docesLogo.JPG" width="175" height="150">
            </div>

        </div> <!-- FIM CardEmpresas -->


    </main>

    <script>
        const { getProductById } = require("../../../database.js");
        const fs = require('fs');
        const PDFDocument = require('pdfkit');
      
        document.getElementById('exportPdf').addEventListener('click', async function () {
          // Recupere os dados do banco de dados (por exemplo, uma lista de produtos)
          const produto = await getProductById();
      
          // Crie um novo documento PDF
          const doc = new PDFDocument();
      
          // Adicione dados ao documento PDF
          doc.text('Catálogo Lupa');
          doc.moveDown();

          console.log("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA");
      
          // Gere HTML Dinamicamente  
          function createCardHTML(produto) {
            const imageSrc = getImageSrc(produto);

            return `
                <div class="itemProdutos">
                    <h1>${produto.produto}</h1>
                    <p>Marca: ${produto.marca}</p>
                    <p>Preço: R$ ${produto.preco}</p>
                    <p>Descrição: ${produto.descricao}</p>
                    <button>R$ ${produto.preco}</button>
                    <img src="${imageSrc}" width="175" height="150">
                </div>
            `;

            console.log("entrando na funcao");
          }

            // div para exibir os cards
            const listaProdutosDiv = document.getElementById('CardProdutos');

          // Itere pelos dados e renderize os cards
          produto.forEach((produto) => {
            const cardHTML = createCardHTML(produto); // Chamando a função createCardHTML
            doc.addHTML(cardHTML); // Adicionando o HTML do card ao PDF
          });
      
          // Salve o PDF em um arquivo
          doc.pipe(fs.createWriteStream('Catalogo.pdf'));
          doc.end();
        });
      </script>
      
</body>

</html>